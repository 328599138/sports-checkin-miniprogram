<!--history.wxml-->
<navigation-bar title="æ‰“å¡å†å²" back="{{true}}" color="white" background="rgba(255,255,255,0.1)"></navigation-bar>

<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
    <view class="stats-overview">
      <view class="overview-card">
        <text class="overview-number">{{totalDays}}</text>
        <text class="overview-label">æ€»æ‰“å¡å¤©æ•°</text>
      </view>
      <view class="overview-card">
        <text class="overview-number">{{currentStreak}}</text>
        <text class="overview-label">è¿ç»­æ‰“å¡</text>
      </view>
      <view class="overview-card">
        <text class="overview-number">{{thisMonthCount}}</text>
        <text class="overview-label">æœ¬æœˆæ‰“å¡</text>
      </view>
    </view>

    <!-- æœˆä»½é€‰æ‹© -->
    <view class="month-selector">
      <button class="month-btn" bindtap="previousMonth">â€¹</button>
      <text class="month-text">{{currentMonth}}</text>
      <button class="month-btn" bindtap="nextMonth">â€º</button>
    </view>

    <!-- æ‰“å¡æ—¥å† -->
    <view class="calendar-container">
      <view class="calendar-header">
        <text class="day-header" wx:for="{{['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­']}}" wx:key="*this">{{item}}</text>
      </view>
      <view class="calendar-grid">
        <view class="calendar-day {{item.isToday ? 'today' : ''}} {{item.hasCheckin ? 'checked' : ''}} {{item.isCurrentMonth ? '' : 'other-month'}}" 
              wx:for="{{calendarDays}}" 
              wx:key="date"
              bindtap="showDayDetail"
              data-date="{{item.date}}">
          <text class="day-number">{{item.day}}</text>
          <view class="day-indicator" wx:if="{{item.hasCheckin}}">
            <text class="sport-emoji">{{item.sportEmoji}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ‰“å¡è®°å½•åˆ—è¡¨ -->
    <view class="records-section">
      <text class="section-title">æœ€è¿‘æ‰“å¡è®°å½•</text>
      <view class="records-list">
        <view class="record-item" wx:for="{{recentRecords}}" wx:key="id">
          <view class="record-left">
            <text class="record-emoji">{{item.sportEmoji}}</text>
            <view class="record-info">
              <text class="record-sport">{{item.sportName}}</text>
              <text class="record-date">{{item.displayDate}}</text>
            </view>
          </view>
          <text class="record-time">{{item.displayTime}}</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{recentRecords.length === 0}}">
      <text class="empty-emoji">ğŸ“</text>
      <text class="empty-text">è¿˜æ²¡æœ‰æ‰“å¡è®°å½•</text>
      <text class="empty-desc">å¼€å§‹ä½ çš„è¿åŠ¨æ‰“å¡ä¹‹æ—…å§ï¼</text>
    </view>
  </view>
</scroll-view> 